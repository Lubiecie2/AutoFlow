@{
    ViewData["Title"] = "Logowanie";
}

<div class="login-container">
    <div class="left-section">
        <div class="left-title">
            <h1>Tw√≥j market motoryzacyjny</h1>
            <p>
                Kup lub sprzedaj pojazd w prosty spos√≥b.<br />
                TysiƒÖce ofert samochod√≥w, motocykli i czƒô≈õci.<br />
                Do≈ÇƒÖcz do spo≈Çeczno≈õci AutoFlow ju≈º dzi≈õ!
            </p>
            <div class="left-features">
                <div class="feature-item">
                    <span class="feature-icon">‚úÖ</span>
                    <span>Bezpieczne transakcje</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üîç</span>
                    <span>Zaawansowane wyszukiwanie</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üí∞</span>
                    <span>Najlepsze ceny na rynku</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üì±</span>
                    <span>Dostƒôp z ka≈ºdego urzƒÖdzenia</span>
                </div>
            </div>
        </div>
    </div>
    <div class="right-section">
        <div class="login-form">
            <div class="back-button">
                <button class="square-btn" onclick="window.location.href='/'">
                    ‚Üê
                </button>
                <span class="back-text">Powr√≥t</span>
            </div>
            <div class="welcome-text">
                <h2>Witaj!</h2>
                <p>Zaloguj siƒô na swoje konto.</p>
            </div>
            <div class="login-input">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Nazwa u≈ºytkownika:</label>
                        <input type="text" id="username" name="username" required />
                    </div>
                    <div class="form-group">
                        <label for="password">Has≈Ço:</label>
                        <input type="password" id="password" name="password" required />
                    </div>
                    <p id="errorMessage" class="error-message" style="display: none;"></p>
                    <div class="submit-button-container">
                        <button class="submit-button" type="submit">
                            Zaloguj siƒô
                        </button>
                    </div>
                </form>
            </div>
            <hr class="break-line" />
            <div class="under-text">
                <a>Nie masz konta?</a>
                <a href="/Account/Register" class="button-classic">
                    Zarejestruj siƒô
                </a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');
            
            try {
                const response = await fetch('/Account/Login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    window.location.href = '/';
                } else {
                    errorMessage.textContent = data.message;
                    errorMessage.style.display = 'block';
                }
            } catch (error) {
                errorMessage.textContent = 'WystƒÖpi≈Ç b≈ÇƒÖd podczas logowania';
                errorMessage.style.display = 'block';
            }
        });
    </script>
}
