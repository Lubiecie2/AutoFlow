@{
    ViewData["Title"] = "Rejestracja";
}

<div class="login-container">
    <div class="left-section">
        <div class="left-title">
            <h1>Do≈ÇƒÖcz do AutoFlow</h1>
            <p>
                Rozpocznij swojƒÖ przygodƒô z kupnem i sprzeda≈ºƒÖ pojazd√≥w.<br />
                Zarejestruj siƒô za darmo i zyskaj dostƒôp do:<br />
            </p>
            <div class="left-features">
                <div class="feature-item">
                    <span class="feature-icon">üöó</span>
                    <span>TysiƒÖce ofert samochod√≥w</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">‚≠ê</span>
                    <span>Dodawanie w≈Çasnych og≈Çosze≈Ñ</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üí¨</span>
                    <span>Kontakt z sprzedawcami</span>
                </div>
                <div class="feature-item">
                    <span class="feature-icon">üîî</span>
                    <span>Powiadomienia o nowych ofertach</span>
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 1rem; opacity: 0.9;">
                üìä Ponad <strong>10 000+</strong> aktywnych u≈ºytkownik√≥w<br />
                üöò <strong>5 000+</strong> og≈Çosze≈Ñ dziennie
            </p>
        </div>
    </div>
    <div class="right-section">
        <div class="login-form">
            <div class="back-button">
                <button class="square-btn" onclick="window.location.href='/'">
                    ‚Üê
                </button>
                <span class="back-text">Powr√≥t</span>
            </div>
            <div class="welcome-text">
                <h2>Rejestracja</h2>
                <p>Utw√≥rz nowe konto.</p>
            </div>
            <div class="login-input">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="username">Nazwa u≈ºytkownika:</label>
                        <input type="text" id="username" name="username" required minlength="3" />
                    </div>
                    <div class="form-group">
                        <label for="password">Has≈Ço:</label>
                        <input type="password" id="password" name="password" required minlength="6" />
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Potwierd≈∫ has≈Ço:</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required />
                    </div>
                    <p id="errorMessage" class="error-message" style="display: none;"></p>
                    <div class="submit-button-container">
                        <button class="submit-button" type="submit">
                            Zarejestruj siƒô
                        </button>
                    </div>
                </form>
            </div>
            <hr class="break-line" />
            <div class="under-text">
                <a>Masz ju≈º konto?</a>
                <a href="/Account/Login" class="button-classic">
                    Zaloguj siƒô
                </a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const errorMessage = document.getElementById('errorMessage');
            
            if (password !== confirmPassword) {
                errorMessage.textContent = 'Has≈Ça nie sƒÖ zgodne';
                errorMessage.style.display = 'block';
                return;
            }
            
            try {
                const response = await fetch('/Account/Register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password, confirmPassword })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    window.location.href = '/';
                } else {
                    errorMessage.textContent = data.message;
                    errorMessage.style.display = 'block';
                }
            } catch (error) {
                errorMessage.textContent = 'WystƒÖpi≈Ç b≈ÇƒÖd podczas rejestracji';
                errorMessage.style.display = 'block';
            }
        });
    </script>
}
